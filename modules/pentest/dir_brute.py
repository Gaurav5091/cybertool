from utils.http_utils import HTTPUtils
from config import DIR_FILE

class DirectoryBruteForcer:
    def __init__(self, target_url):
        self.target = target_url.rstrip('/')
        self.findings = []

    def brute_force(self):
        """Brute-force directories using a wordlist"""
        print(f"[*] Brute-forcing directories on {self.target}...")
        try:
            with open(DIR_FILE, "r") as f:
                dirs = [line.strip() for line in f if line.strip()]
            for dir in dirs:
                url = f"{self.target}/{dir}"
                response = HTTPUtils.send_request(url)
                if response and response.status_code == 200:
                    self.findings.append(f"Directory: {url} - Found")
        except FileNotFoundError:
            self.findings.append("Directory: Wordlist file not found")
        return self.findings
